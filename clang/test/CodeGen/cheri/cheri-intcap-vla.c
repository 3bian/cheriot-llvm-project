// NOTE: Assertions have been autogenerated by utils/update_cc_test_checks.py
// RUN: %cheri_cc1 %s -emit-llvm -o - -O2 | FileCheck %s

void callee(int *a);

// CHECK-LABEL: @caller(
// CHECK-NEXT:  entry:
// CHECK-NEXT:    [[TMP0:%.*]] = tail call i64 @llvm.cheri.cap.address.get.i64(ptr addrspace(200) [[LEN:%.*]])
// CHECK-NEXT:    [[VLA:%.*]] = alloca i32, i64 [[TMP0]], align 4
// CHECK-NEXT:    call void @callee(ptr noundef nonnull [[VLA]]) #[[ATTR3:[0-9]+]]
// CHECK-NEXT:    ret void
//
void caller(__uintcap_t len) {
  int ar[len];
  callee(ar);
}
